<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Multi-B2&W2</title>
    <link href="css/reset.css" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <!--<script src="js/oauth.js"></script>-->
    <script src="js/jquery.min.js"></script>
    <script>
        $(document).ready(function (data) {
            var uid = 1234567, uname = 'debug';//debug数据

            var rate = 100, gameurl = switchversion(uid);//基本参数
            var screen = $('#screen img'), chatrecord = $('#chatrecord'), keyrecord = $('#keyrecord');//基本元素

            function switchversion(uid) {
                switch (uid % 2) {
                    case 0: gameurl = 'http://black.s.gerhut.me/'; return gameurl;
                    case 1: gameurl = 'http://white.s.gerhut.me/'; return gameurl;
                    default: gameurl = 'http://black.s.gerhut.me/'; return gameurl;
                }
            }//根据uid奇偶切换版本

            $('#chat button').click(function () {
                var message = $('#chat input')
                if (message.val() != '' && message.val.length <= 40) {
                    $.get('http://bwinput.s.gerhut.me/chat?name=' + uname + '&content=' + decodeURIComponent(message.val()));
                    message.val('');
                }
            })//发送聊天

            function refresh() {
                $(screen).ready(function () {
                    screen.attr('src', gameurl);
                })
                setTimeout(refresh, rate);
            }//刷新游戏屏幕

            function refreshchat() {
                $(chatrecord).ready(function () {
                    chatrecord.load('http://bwinput.s.gerhut.me/chat', function () {  chatrecord.text(chatrecord.text().split('\n').reverse().join('\n')) });
                    
                })
                setTimeout(refreshchat, rate);
            }//刷新聊天记录

            function init() {
                refresh();
                refreshchat();
            }//入口

            init();//调用入口
        })
    </script>
</head>
<body>
    <div id="container">
        <div id="screen"><img src="/images/default.png" /></div>
        <div id="controlpad">
            <div id="keypad">
                <table>
                    <tbody>
                        <tr>
                            <td></td>
                            <td><button onclick="sendkey(87)">↑</button></td>
                            <td></td>
                            <td></td>

                            <td></td>
                            <td></td>
                            <td><button onclick="sendkey(67)">X</button></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><button onclick="sendkey(65)">←</button></td>
                            <td></td>
                            <td><button onclick="sendkey(68)">→</button></td>
                            <td></td>

                            <td></td>
                            <td><button onclick="sendkey(86)">Y</button></td>
                            <td></td>
                            <td><button onclick="sendkey(90)">A</button></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><button onclick="sendkey(83)">↓</button></td>
                            <td></td>
                            <td><button onclick="sendkey(70)">始</button></td>

                            <td><button onclick="sendkey(82)">选</button></td>
                            <td></td>
                            <td><button onclick="sendkey(88)">B</button></td>
                            <td></td>
                        </tr>
                        <tr></tr>
                    </tbody>
                </table>
            </div>
            <div id="chat">
                <input /><button>send</button>
                <pre id="chatrecord"></pre>

                <pre id="keyrecord"></pre>
            </div>





        </div>
        <br style="clear:both" />
    </div>
</body>
</html>
